import{u as $,b as j,c as h,_,h as T,d as q,N as C,O as B}from"./q-3396b8e1.js";import{g as U}from"./q-c1d3cd99.js";function ue(e,t,i){const{checked:r,files:n,options:s,value:l,valueAsDate:a,valueAsNumber:c}=e;return!i||i==="string"?l:i==="string[]"?s?[...s].filter(o=>o.selected&&!o.disabled).map(o=>o.value):r?[...t.value||[],l]:(t.value||[]).filter(o=>o!==l):i==="number"?c:i==="boolean"?r:i==="File"&&n?j(n[0]):i==="File[]"&&n?j([...n]):i==="Date"&&a?a:t.value}function N(e){return[...Object.values(e.internal.fields),...Object.values(e.internal.fieldArrays)]}function W(e){return Object.keys(e.internal.fieldArrays)}function g(e,t){return e.internal.fieldArrays[t]}function K(e){return Object.keys(e.internal.fields)}function A(e,t){return e.internal.fields[t]}function O(e,t){const i=K(e),r=W(e);return typeof t=="string"||Array.isArray(t)?(typeof t=="string"?[t]:t).reduce((n,s)=>{const[l,a]=n;return r.some(c=>c===s)?(r.forEach(c=>{c.startsWith(s)&&a.add(c)}),i.forEach(c=>{c.startsWith(s)&&l.add(c)})):l.add(s),n},[new Set,new Set]).map(n=>[...n]):[i,r]}function M(e,{items:t,initialItems:i,error:r}={items:[],initialItems:[],error:""}){const n=i.join()!==t.join();return{internal:{initialItems:[...i],startItems:[...i],validate:[],consumers:[]},name:e,items:t,error:r,active:!1,touched:n,dirty:n}}function R(e,t){const i=r=>r instanceof Blob?r.size:r;return Array.isArray(e)&&Array.isArray(t)?e.map(i).join()!==t.map(i).join():e instanceof Date&&t instanceof Date?e.getTime()!==t.getTime():Number.isNaN(e)&&Number.isNaN(t)?!1:e!==t}function X(e,{value:t,initialValue:i,error:r}={value:void 0,initialValue:void 0,error:""}){const n=R(i,t);return{internal:{initialValue:i,startValue:i,validate:[],transform:[],elements:[],consumers:[]},name:e,value:t,error:r,active:!1,touched:n,dirty:n}}function I(e,t){return e.split(".").reduce((i,r)=>i==null?void 0:i[r],t)}let x=0;function D(){return x++}function H(e,t){function i(l){var a;return((a=t==null?void 0:t.value)==null?void 0:a.values)&&I(l,t.value.values)}const r=()=>D(),n=l=>{var a;return((a=t==null?void 0:t.value)==null?void 0:a.errors[l])||""},s=(l,a,c)=>Object.entries(a).reduce((o,[y,u])=>{var v;const d=c?`${c}.${y}`:y;if((!u||typeof u!="object"||Array.isArray(u))&&(o[0][d]=X(d,{initialValue:u,value:i(d)??u,error:n(d)})),Array.isArray(u)){const p=u.map(r);o[1][d]=M(d,{initialItems:p,items:((v=i(d))==null?void 0:v.map(r))||[...p],error:n(d)})}return u&&typeof u=="object"&&s(o,u,d),o},l);return s([{},{}],e.value)}async function de(e,t){const i=await e.resolve();return(typeof i=="function"?i():i).safeParse(t)}function k(e,t){return(typeof e!="string"&&!Array.isArray(e)?e:t)||{}}function Y(e,t){e.dirty=t||N(e).some(i=>i.active&&i.dirty)}function Z(e,t){const i=R(t.internal.startValue,t.value);i!==t.dirty&&(t.dirty=i,Y(e,i))}function L(e,t){var i,r;(r=(i=A(e,t))==null?void 0:i.internal.elements[0])==null||r.focus()}function ce(e,t,i,{shouldActive:r=!0,shouldTouched:n=!1,shouldDirty:s=!1,shouldFocus:l=!!i}={}){for(const a of[A(e,t),g(e,t)])a&&(!r||a.active)&&(!n||a.touched)&&(!s||a.dirty)&&(a.error=i,i&&"value"in a&&l&&L(e,t));w(e,!!i)}function G(e,t,i){const{shouldActive:r=!0,shouldTouched:n=!1,shouldDirty:s=!1,shouldValid:l=!1}=k(t,i);return O(e,t)[0].reduce((a,c)=>{const o=A(e,c);return(!r||o.active)&&(!n||o.touched)&&(!s||o.dirty)&&(!l||!o.error)&&(typeof t=="string"?c.replace(`${t}.`,""):c).split(".").reduce((y,u,d,v)=>y[u]=d===v.length-1?o.value:typeof y[u]=="object"&&y[u]||(isNaN(+v[d+1])?{}:[]),a),a},typeof t=="string"?[]:{})}function fe(e,t,i){const[r,n]=O(e,t),s=typeof t=="string"&&r.length===1,l=!s&&!Array.isArray(t),a=k(t,i),{initialValue:c,initialValues:o,keepResponse:y=!1,keepSubmitCount:u=!1,keepSubmitted:d=!1,keepValues:v=!1,keepDirtyValues:p=!1,keepItems:m=!1,keepDirtyItems:Q=!1,keepErrors:S=!1,keepTouched:V=!1,keepDirty:P=!1}=a;r.forEach(E=>{const f=A(e,E);(s?"initialValue"in a:o)&&(f.internal.initialValue=s?c:I(E,o));const F=p&&f.dirty;!v&&!F&&(f.internal.startValue=f.internal.initialValue,f.value=f.internal.initialValue,f.internal.elements.forEach(b=>{b.type==="file"&&(b.value="")})),V||(f.touched=!1),!P&&!v&&!F&&(f.dirty=!1),S||(f.error="")}),n.forEach(E=>{var b;const f=g(e,E),F=Q&&f.dirty;!m&&!F&&(o&&(f.internal.initialItems=((b=I(E,o))==null?void 0:b.map(()=>D()))||[]),f.internal.startItems=[...f.internal.initialItems],f.items=[...f.internal.initialItems]),V||(f.touched=!1),!P&&!m&&!F&&(f.dirty=!1),S||(f.error="")}),l&&(y||(e.response={}),u||(e.submitCount=0),d||(e.submitted=!1)),ie(e)}async function J(e,t,i){const[r,n]=O(e,t),{shouldActive:s=!0,shouldFocus:l=!0}=k(t,i),a=D();e.internal.validators.push(a),e.validating=!0;const c=e.internal.validate?await e.internal.validate(G(e,{shouldActive:s})):{};let o=!Object.keys(c).length;const[y]=await Promise.all([Promise.all(r.map(async u=>{const d=A(e,u);if(!s||d.active){let v;for(const m of d.internal.validate)if(v=await m(d.value),v)break;const p=v||c[u]||"";return p&&(o=!1),d.error=p,p?u:null}})),Promise.all(n.map(async u=>{const d=g(e,u);if(!s||d.active){let v="";for(const m of d.internal.validate)if(v=await m(d.items),v)break;const p=v||c[u]||"";p&&(o=!1),d.error=p}}))]);if(te(e,c,{shouldActive:s}),l){const u=y.find(d=>d);u&&L(e,u)}return w(e,!o),e.internal.validators.splice(e.internal.validators.indexOf(a),1),e.internal.validators.length||(e.validating=!1),o}function ee(e,t,i,{on:r,shouldFocus:n=!1}){r.includes((e.internal.validateOn==="submit"?e.submitted:t.error)?e.internal.revalidateOn:e.internal.validateOn)&&J(e,i,{shouldFocus:n})}async function ve(e,t,i,r,n,s,l){l!==void 0&&(t.value=l);for(const a of t.internal.transform)t.value=await a(t.value,r,n);t.touched=!0,e.touched=!0,Z(e,t),ee(e,t,i,{on:s})}function te(e,t,{shouldActive:i=!0}){const r=Object.entries(t).reduce((n,[s,l])=>([A(e,s),g(e,s)].every(a=>!a||i&&!a.active)&&n.push(l),n),[]).join(" ");r&&(e.response={status:"error",message:r})}function w(e,t){e.invalid=t||N(e).some(i=>i.active&&i.error)}function ie(e){let t=!1,i=!1,r=!1;for(const n of N(e))if(n.active&&(n.touched&&(t=!0),n.dirty&&(i=!0),n.error&&(r=!0)),t&&i&&r)break;e.touched=t,e.dirty=i,e.invalid=r}function ye(e,t){return U($("s_VOLgKQUpNuc",[e,t]),{id:e.getHash()})}function pe(e){return h(()=>_(()=>import("./q-d98712fd.js"),["build/q-d98712fd.js","build/q-3396b8e1.js","build/q-c1d3cd99.js"]),"s_g3iC2s54jgU",[e])}const z=B(h(()=>_(()=>import("./q-e8603b49.js"),["build/q-e8603b49.js","build/q-3396b8e1.js","build/q-c1d3cd99.js"]),"s_vBVRkPF8kFE"));function re({children:e,name:t,type:i,...r}){const{of:n}=r,s=A(n,t);return T(z,{store:s,...r,children:e(s,{name:t,autoFocus:!1,ref:h(()=>_(()=>import("./q-5996c8af.js"),["build/q-5996c8af.js","build/q-3396b8e1.js","build/q-c1d3cd99.js"]),"s_0EFsQ07yXsM",[s]),onInput$:h(()=>_(()=>import("./q-5996c8af.js"),["build/q-5996c8af.js","build/q-3396b8e1.js","build/q-c1d3cd99.js"]),"s_WQShqIriXzI",[s,n,t,i]),onChange$:h(()=>_(()=>import("./q-5996c8af.js"),["build/q-5996c8af.js","build/q-3396b8e1.js","build/q-c1d3cd99.js"]),"s_vNtVq2dMPhY",[s,n,t]),onBlur$:h(()=>_(()=>import("./q-5996c8af.js"),["build/q-5996c8af.js","build/q-3396b8e1.js","build/q-c1d3cd99.js"]),"s_fzfym1ErEFI",[s,n,t])})},0,t)}function ne({children:e,name:t,...i}){const r=g(i.of,t);return T(z,{store:r,...i,children:e(r)},0,t)}function se({of:e,action:t,onSubmit$:i,keepResponse:r,shouldActive:n,shouldTouched:s,shouldDirty:l,shouldFocus:a,reloadDocument:c,children:o,...y}){const{encType:u}=y,d={shouldActive:n,shouldTouched:s,shouldDirty:l,shouldFocus:a};return q("form",{...y,action:t==null?void 0:t.actionPath,"preventdefault:submit":!c,ref:v=>{e.element=v},children:o,onSubmit$:h(()=>_(()=>import("./q-29d4cf4e.js"),["build/q-29d4cf4e.js","build/q-3396b8e1.js","build/q-c1d3cd99.js"]),"s_qmKnyqz75p4",[t,u,e,r,i,d,c])},{method:"post",noValidate:!0},0,"Qg_0")}function ae({loader:e,action:t,validate:i,validateOn:r="submit",revalidateOn:n="input"}){return C(()=>{var a;const[s,l]=H(e,t);return{internal:{fields:s,fieldArrays:l,validate:i,validators:[],validateOn:r,revalidateOn:n},element:void 0,submitCount:0,submitting:!1,submitted:!1,validating:!1,touched:!1,dirty:!1,invalid:!1,response:((a=t==null?void 0:t.value)==null?void 0:a.response)||{}}},{deep:!0})}function he(e){const t=ae(e);return[t,{Form:i=>se({of:t,action:e.action,...i}),Field:i=>re({of:t,...i}),FieldArray:i=>ne({of:t,...i})}]}export{G as a,te as b,D as c,he as d,de as e,ye as f,ue as g,ve as h,fe as r,ce as s,ie as u,J as v,pe as z};
